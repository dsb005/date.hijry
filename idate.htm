<html>
<head>
<title>Tsting arDate</title>
</head>
<body>
<script language="javascript">
//4-9-9
//  [year(4)]  [Year-start-time(9-10)]  [Year-end-time(9-10)]  [month-29days(*)]  [months-30days(*)]
//  Total Length (49,50,52)
// Time Length (9-9)-(9-10)-(10-10) [Only Year Start and Finish Times]
var keys = new Array('1400@311893200@339973200@0305070810@01020406091112','1401@342478800@370558800@010406080911@020305071012','1402@373064400@401144400@010507091012@020304060811','1403@403736400@431816400@0206081011@01030405070912','1404@434322000@462402000@010205091112@030406070810','1405@464994000@493074000@0203060911@01040507081012','1406@495579600@523659600@010305070912@020406081011','1407@526251600@554245200@020406081012@010305070911','1408@556837200@584830800@030507091012@010204060811','1409@587422800@615502800@0306081011@01020405070912','1410@618008400@646088400@010307091112@020405060810','1411@648680400@676760400@0204071012@01030506080911','1412@679266000@707432400@0103040711@02050608091012','1413@709938000@738018000@010204050811@030607091012','1414@740610000@768603600@020305060812@010407091011','1415@771195600@799189200@020406070912@010305081011','1416@801781200@829774800@030507091012@010204060811','1417@832366800@860446800@0305081012@01020406070911','1418@862952400@891118800@0103050911@02040607081012','1419@893624400@921704400@010204060912@030507081011','1420@924296400@952376400@0204050712@01030608091011','1421@954968400@982962000@020305060712@010408091011','1422@985554000@1013547600@030406070812@010205091011','1423@1016139600@1044133200@030507081012@010204060911','1424@1046725200@1074805200@0306080911@01020405071012','1425@1077310800@1105477200@0103060811@02040507091012','1426@1107982800@1136062800@010204060912@030507081011','1427@1138654800@1166734800@0203050710@01040608091112','1428@1169240400@1197320400@010304060711@020508091012','1429@1199912400@1227906000@020405070811@010306091012','1430@1230498000@1258491600@020506081012@010304070911','1431@1261083600@1289077200@020507091112@010304060810','1432@1291669200@1319749200@0206081012@01030405070911','1433@1322254800@1350421200@0103060911@02040507081012','1434@1352926800@1381006800@010204060912@030507081011','1435@1383512400@1411592400@010305070912@020406081011','1436@1414184400@1442178000@020406081012@010305070911','1437@1444770000@1472763600@030607091112@010204050810','1438@1475355600@1503435600@0307081011@01020405060912','1439@1505941200@1534021200@010307091112@020405060810','1440@1536613200@1564693200@0204081012@01030506070911','1441@1567198800@1595365200@0103050811@02040607091012','1442@1597870800@1625950800@010204060811@030507091012','1443@1628456400@1656536400@010305070911@020406081012','1444@1659128400@1687122000@020407081012@010305060911','1445@1689714000@1717707600@020608091112@010304050710','1446@1720299600@1748379600@0206091012@01030405070811','1447@1750885200@1779051600@0103070911@02040506081012','1448@1781557200@1809637200@010204071012@030506080911','1449@1812229200@1840309200@0203050710@01040608091112','1450@1842814800@1873314000@010305060810@020407091112');

function findDate(y,m,d)
{
	var fdate = new Date(y,m,d);
	var dtime = fdate.getTime();
	var vals;
	var stimes;
	var stimef;
	var y='NO'; // Year Index
	for(var i=0; i<keys.length; i++)
	{
		var vals = keys[i].split('@');
		stimes = vals[1]*1000;
		stimef = vals[2]*1000;
		if(dtime >= stimes && dtime <= stimef)
		{
			y=i;
			break;
		}
	}
	if(y != 'NO')
	{
		// Find Year
		var months = new Array();
		// Collect Months
		months[0] = getMonhts(vals[3]);
		months[1] = getMonhts(vals[4]);
		//alert(months[0]); alert(months[1]);
		// Collect Days
		var tday = (60*60*24*1000);
		var cday;
		var oday=0;
		var fday;
		var sday;
		var dlimit;
		var d;
		var dfound=false;
		findday:
		for(i=0; i<12; i++)
		{
			m=i+1;
			// Find Days Limit
			if(in_array(m,months[0]))
				dlimit=29;
			else if(in_array(m,months[1]))
				dlimit=30;
			else
			{
				var tval = in_array(m,months[1]);
				break;
			}
			
			// Check in Days
			for(x=0; x<dlimit; x++)
			{
				d=x+1;
				if(oday == 0)
					cday = (vals[1]*1000)+((tday*d)*m);
				else
					cday = oday+tday;
				fday = cday+tday;
				if(dfound)
				{
					sday = new Array(vals[0],m,d);
					var td = new Date(dtime);
					var sd = new Date(cday);
					alert(sd);
					break findday;
				}
				else if((fday - dtime) >= 0)
				{
					alert('(fday='+fday+'-dtime='+dtime+')='+(fday-dtime));
					dfound = true;
				}
				else
					dfound = false;
				oday = cday;
			}
			/*
			for($x=0; $x<$dlimit; $x++)
			{
				$d=$x+1;
				if($oday == 0)
					$cday = ($vals[1])+(($tday*$d)*$m);
				else
					$cday = $oday+$tday;
				$fday = $cday+$tday;
				if($dfound)
				{
					$sday = array($vals[0],$m,$d);
					$sd = Date($cday);
					$td = Date($dtime);
					break 2;
				}
				elseif(($fday - $dtime) > 0)
					$dfound = true;
				else
					$dfound = false;
				$oday = $cday;
			}
			*/
		}
		// Result
		//return sday;
		document.write(sday+'<br>');
	}
	else
		return false;
}

// sort Numbers
function sortfunc(a,b)
{
	return a - b;
}
// Check if in Array
function in_array(val,arr)
{
	for(v in arr)
		if(arr[v] == val)
			return true;
	return false;
}
// Collect Monhts
function getMonhts(mstr)
{
	var slen = mstr.length/2;
	var f=0;
	var z=0;
	var months = new Array();
	for(var x=0; x<slen; x++)
	{
		f=z+1;
		m = mstr.substr(z,2);
		if(m.substr(0,1) == 0) m = mstr.substr(f,1);
		months[x] = m;
		z+=2;
	}
	return months;
}
findDate(1985,02,15);
//findDate(2012,05,15);
</script>
</body>
</html>
